var v=Object.defineProperty;var R=(t,s,e)=>s in t?v(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var o=(t,s,e)=>R(t,typeof s!="symbol"?s+"":s,e);import{j as n,C as u,e as S}from"./index-Cj2qvoiD.js";import{R as c,r as _,d as I,N as b}from"./vendor_react-BlCfV_Ce.js";import{W as k}from"./index-BBos-l7d.js";const y="_Main_6rwql_1",P={Main:y},w="_Status_btvvi_1",N={Status:w},L=({className:t,children:s})=>n.jsx("h4",{className:N.Status,children:n.jsx("span",{className:t,children:s})}),p=c.memo(L),E="_Title_18vma_2",F={Title:E},M=({className:t,title:s,children:e})=>n.jsx("div",{className:F.Title,children:n.jsxs("span",{className:t,children:[n.jsx("h1",{children:s}),n.jsx("h3",{children:e})]})}),q=c.memo(M),A="_Form_5krnw_1",D={Form:A},O="_TextInput_1xfaq_1",W={TextInput:O},G=({className:t,name:s,value:e,changed:r,placeholder:a,required:i,focus:l})=>n.jsx("span",{className:W.TextInput,children:n.jsx("input",{type:"text",className:t,name:s,value:e,onChange:r,placeholder:a,required:i,autoFocus:l})}),H=c.memo(G),J=({className:t,name:s,value:e,changed:r,placeholder:a,required:i,focus:l},$)=>n.jsx(H,{className:t,name:s,value:e,changed:r,placeholder:a,required:i,focus:l},$),U=({inputs:t})=>t instanceof Array?t.map(J):null,z=c.memo(U),B=({className:t,submited:s,children:e,textInputList:r,submitText:a,locked:i})=>n.jsx("div",{className:D.Form,children:n.jsx("span",{className:t,children:n.jsxs("form",{onSubmit:s,children:[e,n.jsx(z,{inputs:r}),n.jsx("input",{type:"submit",value:a,disabled:i})]})})}),K=c.memo(B),Q=({error:t,route:s})=>{if(t)return n.jsxs("span",{children:["Error trying to generate link.",n.jsx("br",{}),t instanceof Error?t.message:t]});if(s){const e=`${u.server}/@/${s}`;return n.jsxs("span",{children:["Generated at ",n.jsx("a",{href:e,children:e})]})}return n.jsx(n.Fragment,{})};class m{constructor(s,e){o(this,"route");o(this,"error");o(this,"generate",()=>m.build(this.route,this.error));this.error=e,this.route=s}static build(s,e){return n.jsx(Q,{error:e,route:s})}}const V="Nothing returned",d=new Headers({"Content-Type":"application/json","Access-Control-Allow-Origin":"*"});class h{}o(h,"count",()=>{const s=new Request(`${u.server}/count`,{method:"GET",headers:d});return T(s,10).then(x)}),o(h,"shorten",(s,e)=>{const r=new Request(`${u.server}/`,{method:"POST",body:JSON.stringify({link:s,shrt:e}),headers:d});return fetch(r).then(x).then(a=>a?Promise.resolve(j(a.shrt)):Promise.reject(V)).catch(a=>Y(a).then(i=>Promise.resolve(j(null,i))))});const T=(t,s,e)=>fetch(t).catch(r=>s===1?Promise.reject(r):X(5e3).then(()=>T(t,s-1))),X=t=>new Promise(s=>setTimeout(s,t)),x=t=>t.ok?t.json():Promise.reject(t.json()),Y=t=>(t instanceof Promise?t:Promise.resolve(t)).then(e=>Promise.resolve(e instanceof Error?e.message:e)),j=(t,s)=>m.build(t,s),g="Please enter a link to shorten",C="Waiting for server calculations...";class Z extends _.PureComponent{constructor(){super(...arguments);o(this,"state",{link:"",shrt:"",response:g,loading:!1,countResponse:C});o(this,"getStatus",()=>this.state.loading?"Loading...":this.state.response);o(this,"getTextInputList",()=>[{name:"link",value:this.state.link,changed:this.handleInputChange,placeholder:"🌐 Enter the long URL",required:!0,focus:!0},{name:"shrt",value:this.state.shrt,changed:this.handleInputChange,placeholder:"🌐 Custom alias (optional)"}]);o(this,"setLoading",(e=!0)=>this.setState({loading:e}));o(this,"setCountResponse",e=>this.setState({countResponse:e}));o(this,"setResponse",(e=g)=>this.setState({response:e}));o(this,"callCount",()=>h.count().then(e=>this.setCountResponse(`There are ${e} shortened links!`)).catch(e=>{console.error(e),this.setCountResponse("An error has occurred!")}));o(this,"handleInputChange",e=>{e.preventDefault();const{name:r,type:a,checked:i,value:l}=e.target;this.setState({[r]:a==="checkbox"?i:l})});o(this,"shorten",e=>{e.preventDefault();const{link:r,shrt:a}=this.state;if(!r){this.setResponse();return}this.setLoading(),this.setCountResponse(C),h.shorten(r,a).then(i=>{this.setResponse(i),this.setLoading(!1),this.callCount()})})}componentDidMount(){this.callCount()}render(){return n.jsxs(k,{children:[n.jsx(q,{title:"Shrtr",children:"The independent shortener"}),n.jsx(p,{children:this.state.countResponse}),n.jsx(p,{children:this.getStatus()}),n.jsx(K,{submited:this.shorten,locked:this.state.loading,submitText:"Shorten 🔗",textInputList:this.getTextInputList()})]})}}const tt="_Color_c0j15_1",et={Color:tt},st=1<<24,f=()=>{const t=`#${(st*Math.random()|0).toString(16)}`;document.documentElement.style.setProperty("--main-bg-color",t)},nt=()=>n.jsxs(n.Fragment,{children:[f(),n.jsx("input",{className:et.Color,type:"button",value:"New Color 🎨",onClick:f})]}),ot=c.memo(nt),lt=()=>I().search==="?error"?n.jsx(b,{to:S}):n.jsxs("div",{className:P.Main,children:[n.jsx(ot,{}),n.jsx(Z,{})]});export{lt as default};
